<!-- Company Profile -->
<div class="relative pt-32 pb-20">
  <!-- Company profile card -->
  <div
    class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl border border-gray-100 dark:border-gray-700 overflow-hidden max-w-6xl mx-auto"
  >
    <!-- Header section -->
    <div [class]="'relative px-8 pt-12 pb-8 company-header--' + company().colorScheme.theme">
      <!-- Decorative elements -->
      <app-decorative-background [elements]="backgroundElements"></app-decorative-background>

      <!-- Company logo and info -->
      <div class="relative z-10 text-center">
        <div class="inline-block relative group">
          <a
            [href]="company().website || '#'"
            [target]="company().website ? '_blank' : '_self'"
            class="block"
            [class.pointer-events-none]="!company().website"
          >
            <div
              class="w-32 h-32 rounded-full p-6 mx-auto mb-6 shadow-2xl border-4 border-white transition-colors duration-300"
              [style.background]="getLogoBackgroundStyle(company().logoBackground)"
              [ngClass]="'group-hover:border-' + company().colorScheme.primary"
            >
              <img class="w-full h-full object-contain" [src]="company().logoSrc" [alt]="company().logoAlt" />
            </div>
          </a>

          <!-- Floating external link icon -->
          @if (company().website) {
            <div
              [ngClass]="
                'absolute -top-2 -right-2 w-8 h-8 bg-' +
                company().colorScheme.primary +
                ' rounded-full flex items-center justify-center shadow-lg'
              "
            >
              <ng-icon name="heroArrowTopRightOnSquare" size="0.875rem" class="text-white"></ng-icon>
            </div>
          }
        </div>

        <h2 class="text-4xl font-bold text-white mb-6">{{ company().name }}</h2>

        <!-- Company details -->
        <div class="flex flex-wrap justify-center gap-6 text-gray-300">
          <div class="flex items-center space-x-2">
            <ng-icon name="heroMapPin" size="1rem" class="text-green-400"></ng-icon>
            <span>{{ company().location }}</span>
          </div>
          <div class="flex items-center space-x-2">
            <ng-icon name="heroBriefcase" size="1rem" class="text-emerald-400"></ng-icon>
            <span>{{ company().position }}</span>
          </div>
          <div class="flex items-center space-x-2">
            <ng-icon name="heroCalendarDays" size="1rem" class="text-lime-400"></ng-icon>
            <span>{{ getDateRange() }}</span>
          </div>
          @if (company().department) {
            <div class="flex items-center space-x-2 w-full justify-center md:w-auto">
              <ng-icon name="heroAcademicCap" size="1rem" class="text-lime-400"></ng-icon>
              <span>{{ company().department }}</span>
            </div>
          }
        </div>

        <!-- Acquisition Chain & History -->
        @if ((company().acquisitionChain && company().acquisitionChain!.length > 0) || company().acquiredBy) {
          <div class="mt-8 max-w-3xl mx-auto">
            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
              <h4 class="text-sm font-semibold text-white/90 mb-4 uppercase tracking-wider">Company History</h4>

              <!-- Acquisition Chain (predecessors) -->
              @if (company().acquisitionChain && company().acquisitionChain!.length > 0) {
                <div class="space-y-3 mb-4">
                  @for (acquisition of company().acquisitionChain!; track acquisition.companyId) {
                    <div class="flex items-start gap-4 pl-4 border-l-2 border-white/30">
                      <div class="flex-1">
                        <a
                          [routerLink]="getCompanyRoute(acquisition.companyId)"
                          class="text-white font-semibold hover:text-white/80 transition-colors underline decoration-white/40 hover:decoration-white/60"
                        >
                          {{ getCompanyName(acquisition.companyId) }}
                        </a>
                        <div class="text-white/70 text-sm">{{ acquisition.position }}</div>
                        <div class="text-white/60 text-xs mt-1">
                          {{ getAcquisitionDateRange(acquisition.dateStart, acquisition.dateEnd) }}
                        </div>
                      </div>
                    </div>
                  }
                </div>
              }

              <!-- Acquired By (successor) -->
              @if (company().acquiredBy) {
                <div class="pt-3 border-t border-white/20">
                  <div class="flex items-center gap-2 text-white/80 text-sm">
                    <ng-icon name="heroArrowPathRoundedSquare" size="1rem" class="text-white/60"></ng-icon>
                    <span
                      >Acquired by
                      <a
                        [routerLink]="getCompanyRoute(company().acquiredBy!.companyId)"
                        class="font-bold text-white hover:text-white/80 transition-colors underline decoration-white/40 hover:decoration-white/60"
                      >
                        {{ getCompanyName(company().acquiredBy!.companyId) }}
                      </a>
                      in {{ formatAcquisitionMonth(company().acquiredBy!.acquisitionDate) }}</span
                    >
                  </div>
                </div>
              }
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Stats section -->
    <div
      [class]="
        'px-8 py-6 stats-section--' + company().colorScheme.theme + ' border-b border-gray-100 dark:border-gray-700'
      "
    >
      <div class="grid grid-cols-3 gap-6">
        <div class="text-center">
          <div class="text-3xl font-bold text-green-600 mb-1">
            {{ company().stats.years }}
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-300 font-medium">Years</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-emerald-600 mb-1">
            {{ company().stats.projects.value }}
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-300 font-medium">
            {{ company().stats.projects.label }}
          </div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-lime-600 mb-1">
            {{ company().stats.clients.value }}
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-300 font-medium">
            {{ company().stats.clients.label }}
          </div>
        </div>
      </div>
    </div>

    <!-- Content section -->
    <div class="px-8 py-12">
      <div class="max-w-6xl mx-auto">
        <!-- Employment Mode: Company Overview First -->
        @if (viewMode() === 'employment') {
          <!-- Company overview -->
          <div class="bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 mb-8 border border-gray-200 dark:border-gray-700">
            <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4 flex items-center">
              <ng-icon
                name="heroBuildingOffice"
                size="1.25rem"
                [class]="getIconClass(company().colorScheme.theme) + ' mr-3'"
              ></ng-icon>
              About {{ company().name }}
            </h3>
            <p class="text-gray-700 dark:text-gray-300 leading-relaxed" [class.mb-6]="company().achievements">
              {{ company().description }}
            </p>

            <!-- Key Responsibilities & Achievements section -->
            @if (company().achievements) {
              <div class="bg-white dark:bg-gray-700 rounded-xl p-6 border border-blue-100 dark:border-gray-600">
                <h4 class="font-semibold text-gray-800 dark:text-gray-100 mb-3 flex items-center">
                  <ng-icon
                    name="heroCog6Tooth"
                    size="1rem"
                    [class]="getIconClass(company().colorScheme.theme) + ' mr-2'"
                  ></ng-icon>
                  Key Responsibilities & Achievements
                </h4>
                <app-bullet-list
                  [items]="getAchievementItems()"
                  bulletStyle="dot"
                  size="sm"
                  spacing="normal"
                  colorTheme="blue"
                ></app-bullet-list>
              </div>
            }
          </div>

          <!-- Employment Mode: Compact Projects List -->
          @if (projects().length > 0) {
            <div class="bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 mb-8 border border-gray-200 dark:border-gray-700">
              <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4 flex items-center">
                <ng-icon
                  name="heroCodeBracket"
                  size="1.25rem"
                  [class]="getIconClass(company().colorScheme.theme) + ' mr-3'"
                ></ng-icon>
                Projects Worked On
              </h3>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                @for (project of projects(); track project.name) {
                  <a
                    [routerLink]="project.route"
                    class="group flex items-center gap-4 p-4 bg-white dark:bg-gray-700 rounded-xl border border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:shadow-md transition-all duration-200"
                  >
                    <div
                      [class]="
                        'w-10 h-10 rounded-lg flex items-center justify-center shrink-0 bg-gradient-to-r ' +
                        project.color
                      "
                    >
                      <ng-icon [name]="project.icon" size="1rem" class="text-white"></ng-icon>
                    </div>
                    <div class="flex-1 min-w-0">
                      <h4
                        class="font-semibold text-gray-800 dark:text-gray-100 truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"
                      >
                        {{ project.name }}
                      </h4>
                      <p class="text-xs text-gray-500 dark:text-gray-400 truncate">{{ project.status }}</p>
                    </div>
                    <ng-icon
                      name="heroArrowRight"
                      size="0.875rem"
                      class="text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 group-hover:translate-x-1 transition-all"
                    ></ng-icon>
                  </a>
                }
              </div>
              <div class="mt-6 text-center">
                <a
                  [routerLink]="company().projectsRoute"
                  [class]="
                    'inline-flex items-center gap-2 px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 hover:shadow-md project-button--' +
                    company().colorScheme.theme +
                    ' text-white'
                  "
                >
                  <ng-icon name="heroRectangleStack" size="1rem"></ng-icon>
                  View All Project Details
                </a>
              </div>
            </div>
          }
        } @else {
          <!-- Projects Mode: Full Projects Grid -->
          <div class="mb-8">
            <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6 flex items-center">
              <ng-icon
                name="heroCodeBracket"
                size="1.25rem"
                [class]="getIconClass(company().colorScheme.theme) + ' mr-3'"
              ></ng-icon>
              Featured Projects
            </h3>
            <div
              [class]="'grid gap-6 mb-8 ' + (projects().length === 1 ? 'grid-cols-1' : 'grid-cols-1 md:grid-cols-2')"
            >
              @for (project of projects(); track project.name) {
                <div
                  class="group bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-2xl border border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 overflow-hidden transition-all duration-300 transform hover:-translate-y-1"
                >
                  <!-- Project Header -->
                  <div [class]="'relative project-card-header px-6 py-8 text-white bg-gradient-to-r ' + project.color">
                    <app-decorative-background [elements]="projectBackgroundElements"></app-decorative-background>
                    <div class="relative z-10">
                      <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                          <ng-icon [name]="project.icon" size="1.25rem" class="text-white"></ng-icon>
                        </div>
                        <span class="px-3 py-1 bg-white/20 rounded-full text-white text-xs font-medium">
                          {{ project.status }}
                        </span>
                      </div>
                      <h4 class="text-xl font-bold text-white mb-2">
                        {{ project.name }}
                      </h4>
                      <p class="text-white/90 text-sm">{{ project.description }}</p>
                    </div>
                  </div>

                  <!-- Project Details -->
                  <div class="p-6">
                    <p class="text-gray-800 dark:text-gray-200 mb-4 leading-relaxed">
                      {{ project.description }}
                    </p>
                    <div class="flex flex-wrap gap-2 mb-4">
                      @for (tech of project.technologies; track $index) {
                        <span [class]="'px-3 py-1 text-sm font-medium rounded-full ' + getTechBadgeClass($index)">
                          {{ tech }}
                        </span>
                      }
                    </div>

                    <div class="flex justify-between items-center">
                      <div class="flex gap-2">
                        <!-- Technology badges moved above -->
                      </div>
                      <a
                        [routerLink]="project.route"
                        [class]="
                          getProjectLinkClass(company().colorScheme.theme) +
                          ' font-medium text-sm flex items-center group-hover:translate-x-1 transition-transform'
                        "
                      >
                        View Details
                        <ng-icon name="heroArrowRight" size="0.75rem" class="ml-2"></ng-icon>
                      </a>
                    </div>
                  </div>
                </div>
              }
            </div>
          </div>

          <!-- Company overview -->
          <div class="bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 mb-8 border border-gray-200 dark:border-gray-700">
            <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4 flex items-center">
              <ng-icon
                name="heroBuildingOffice"
                size="1.25rem"
                [class]="getIconClass(company().colorScheme.theme) + ' mr-3'"
              ></ng-icon>
              About {{ company().name }}
            </h3>
            <p class="text-gray-700 dark:text-gray-300 leading-relaxed" [class.mb-6]="company().achievements">
              {{ company().description }}
            </p>

            <!-- Key Responsibilities & Achievements section -->
            @if (company().achievements) {
              <div class="bg-white dark:bg-gray-700 rounded-xl p-6 border border-blue-100 dark:border-gray-600">
                <h4 class="font-semibold text-gray-800 dark:text-gray-100 mb-3 flex items-center">
                  <ng-icon
                    name="heroCog6Tooth"
                    size="1rem"
                    [class]="getIconClass(company().colorScheme.theme) + ' mr-2'"
                  ></ng-icon>
                  Key Responsibilities & Achievements
                </h4>
                <app-bullet-list
                  [items]="getAchievementItems()"
                  bulletStyle="dot"
                  size="sm"
                  spacing="normal"
                  colorTheme="blue"
                ></app-bullet-list>
              </div>
            }
          </div>
        }

        <!-- Project content -->
        @if (hasActiveChildRoute()) {
          <div
            class="prose prose-lg dark:prose-invert max-w-none mb-8 bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-200 dark:border-gray-700"
            #projectDetailsSection
          >
            <router-outlet></router-outlet>
          </div>
        }

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          @if (company().website) {
            <a
              [href]="company().website"
              target="_blank"
              [class]="
                'inline-flex items-center px-6 py-3 project-button--' +
                company().colorScheme.theme +
                ' text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200'
              "
            >
              <ng-icon name="heroArrowTopRightOnSquare" size="1rem" class="mr-3"></ng-icon>
              <span>Visit Company Website</span>
            </a>
          }

          <a
            routerLink="/personal/resume"
            class="inline-flex items-center px-6 py-3 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-semibold rounded-xl border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"
          >
            <ng-icon name="heroRectangleStack" size="1rem" class="mr-3"></ng-icon>
            <span>See Full Resume</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
